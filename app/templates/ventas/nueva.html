{% extends "base.html" %}
{% block contenido %}

<h3>Nueva venta</h3>

<form method="POST" class="row g-3" autocomplete="off">

    <!-- hidden que almacena el id del producto seleccionado -->
    <input type="hidden" name="producto_id" id="producto_id_hidden">

    <div class="col-md-6 position-relative">
        <label>Producto</label>
        <!-- input visible donde el usuario escribe -->
        <input id="searchProducto" name="producto_nombre" class="form-control" autocomplete="off">
        <!-- contenedor de sugerencias (position absolute para superponer) -->
        <div id="sugerencias" class="list-group position-absolute w-100" style="z-index:1000;"></div>
    </div>

    <div class="col-md-3">
        <label>Cantidad</label>
        <input name="cantidad" type="number" step="0.01" class="form-control" value="1">
    </div>

    <div class="col-md-3 d-flex align-items-end">
        <button class="btn btn-primary w-100">Agregar</button>
    </div>
</form>

<h4 class="mt-4">Carrito</h4>

<table class="table table-bordered">
<thead>
<tr>
    <th>Producto</th>
    <th>Cantidad</th>
    <th>Subtotal</th>
    <th></th>
</tr>
</thead>
<tbody>
{% for item in carrito %}
<tr>
    <td>{{item.nombre}}</td>
    <td>{{item.cantidad}}</td>
    <td>${{item.subtotal}}</td>
    <td><a href="{{ url_for('ventas.quitar', idx=loop.index0) }}" class="btn btn-sm btn-danger">Quitar</a></td>
</tr>
{% endfor %}
</tbody>
</table>

<h4>Total: ${{total}}</h4>

<a class="btn btn-success" href="{{ url_for('ventas.finalizar') }}">Finalizar venta</a>

{% endblock %}
